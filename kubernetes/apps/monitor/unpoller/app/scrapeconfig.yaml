---
# yaml-language-server: $schema=https://crd.movishell.pl/monitoring.coreos.com/scrapeconfig_v1alpha1.json
apiVersion: monitoring.coreos.com/v1alpha1
kind: ScrapeConfig
metadata:
  name: &name unpoller
spec:
  jobName: unpoller
  scrapeInterval: 30s
  staticConfigs:
    - targets:
        - https://unifi.${PRIVATE_DOMAIN}
        - https://unifi.ostroda.${PRIVATE_DOMAIN}
  metricsPath: /scrape
  relabelings:
    - sourceLabels: [__address__]
      targetLabel: __param_target
    - sourceLabels: [__param_target]
      targetLabel: instance
    - targetLabel: __address__
      replacement: unpoller:9130
  # metricRelabelings:
  #   - sourceLabels: [site_name, instance]
  #     regex: 'Default \(default\);https://unifi\.ishioni\.casa'
  #     targetLabel: site_name
  #     replacement: MoviNet
  #   - sourceLabels: [site_name, instance]
  #     regex: 'Default \(default\);https://unifi\.ostroda\.ishioni\.casa'
  #     targetLabel: site_name
  #     replacement: Ostr√≥da
